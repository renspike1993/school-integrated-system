{% load static %} {% load custom_filters %}
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Admin Dashboard</title>

		<script src="https://cdn.tailwindcss.com"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

		<script>
			tailwind.config = {
				theme: {
					extend: {
						colors: {
							soft: {
								50: "#fafafa",
								100: "#f4f4f5",
								200: "#e4e4e7",
								300: "#d4d4d8",
								400: "#a1a1aa",
								500: "#71717a",
								600: "#52525b",
								700: "#3f3f46",
								800: "#27272a",
								900: "#18181b",
							},
							accent: {
								500: "#4F46E5",
								600: "#4338CA",
								700: "#3730A3",
							},
						},
						fontFamily: {
							sans: ["Inter", "system-ui", "sans-serif"],
						},
					},
				},
			};
		</script>

		<style>
			@import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap");

			* {
				font-family: "Inter", sans-serif;
			}

			.thin-sidebar {
				transition: all 0.2s ease;
			}

			.slim-scrollbar::-webkit-scrollbar {
				width: 3px;
			}

			.slim-scrollbar::-webkit-scrollbar-track {
				background: transparent;
			}

			.slim-scrollbar::-webkit-scrollbar-thumb {
				background: #4b5563;
				border-radius: 2px;
			}

			.dark-sidebar {
				background: linear-gradient(180deg, #1f2937 0%, #111827 100%);
			}
		</style>
	</head>

	<body class="bg-soft-50 text-soft-700">
		<div class="flex h-screen overflow-hidden">
			<!-- DARK ELEGANT SIDEBAR -->
			<aside class="thin-sidebar w-16 lg:w-52 dark-sidebar border-r border-gray-700 flex flex-col">
				<!-- Logo -->
				<div class="px-4 py-5 border-b border-gray-700">
					<div class="flex items-center space-x-2 lg:space-x-3">
						<div class="w-8 h-8 rounded-md bg-gradient-to-r from-accent-500 to-purple-600 flex items-center justify-center text-white text-xs shadow-lg">
							<i class="fa-solid fa-cube"></i>
						</div>
						<span class="hidden lg:block text-sm tracking-wide font-semibold text-white"> LIBRARY<span class="text-accent-400"></span> </span>
					</div>
				</div>

				<!-- User -->
				<div class="px-4 py-4 border-b border-gray-700 flex items-center space-x-3">
					<div class="h-8 w-8 rounded-full bg-gradient-to-r from-accent-500 to-purple-600 text-white flex items-center justify-center text-xs shadow-md">RC</div>
					<div class="hidden lg:block">
						<p class="text-xs font-medium text-white">{{ request.user.get_full_name|default:request.user.username }}</p>
						<p class="text-[11px] text-gray-400">{{ request.user.role|default:"Super Admin" }}</p>
					</div>
				</div>

				<!-- Navigation -->
				<nav class="flex-1 overflow-y-auto slim-scrollbar py-4">
					<ul class="space-y-1 px-3 text-sm">
						{% comment %} DASHBOARD {% endcomment %}
						<li>
							<a href="{% url 'dashboard' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'dashboard' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-gauge text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Dashboard</span>
							</a>
						</li>

						<li>
							<a href="{% url 'all_books_borrow_history' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'transactions' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-arrow-right-arrow-left text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Transactions</span>
							</a>
						</li>

						<li>
							<a href="{% url 'collection_list' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'collection_list' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-folder text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Collections</span>
							</a>
						</li>

						<li>
							<a href="{% url 'book_list' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'book_list' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-book text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Books</span>
							</a>
						</li>

						<li>
							<a href="{% url 'library_students' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'library_students' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-users text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Students</span>
							</a>
						</li>

						<li>
							<a href="{% url 'library_students' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 transition-all duration-200 {% if request.resolver_match.url_name == 'staffs' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-users text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Faculty & Staffs</span>
							</a>
						</li>
					</ul>

					<div class="hidden lg:block px-3 mt-6 mb-2 text-[11px] uppercase text-gray-500 tracking-wider">Tools</div>

					<ul class="space-y-1 px-3 text-sm">
						<li>
							<a href="{% url 'opac' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 text-gray-300 transition-all duration-200">
								<i class="fa-solid fa-boxes text-xs w-4"></i>
								<span class="hidden lg:block ml-3">OPAC</span>
							</a>
						</li>

						<li>
							<a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 text-gray-300 transition-all duration-200">
								<i class="fa-solid fa-boxes text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Inventory</span>
							</a>
						</li>
						<li>
							<a href="#" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 text-gray-300 transition-all duration-200">
								<i class="fa-solid fa-chart-bar text-xs w-4"></i>
								<span class="hidden lg:block ml-3">Reports</span>
							</a>
						</li>
						<li>
							<a href="{% url 'manual' %}" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-700 text-gray-300 transition-all duration-200 {% if request.resolver_match.url_name == 'manual' %} bg-gray-700 text-white {% else %} text-gray-300 {% endif %}">
								<i class="fa-solid fa-book-open text-xs w-4"></i>
								<span class="hidden lg:block ml-3">User Manual</span>
							</a>
						</li>
					</ul>
				</nav>

				<!-- Logout -->
				<div class="border-t border-gray-700 p-3">
					{% if user.is_authenticated %}
					<form method="POST" action="{% url 'logout' %}">
						{% csrf_token %}
						<button class="flex items-center w-full px-3 py-2 text-sm rounded-lg hover:bg-gray-700 text-gray-300 transition-all duration-200" type="submit">
							<i class="fa-solid fa-arrow-right-from-bracket text-xs w-4"></i>
							<span class="hidden lg:block ml-3">Logout</span>
						</button>
					</form>
					{% endif %}
				</div>
			</aside>

			<!-- MAIN AREA -->
			<div class="flex-1 flex flex-col overflow-hidden">
				<!-- HEADER -->
				<header class="bg-white border-b border-soft-200 px-4 py-3 flex items-center justify-between">
					<div class="flex items-center space-x-2">
						<button id="sidebarToggle" class="p-2 rounded-md hover:bg-soft-100 text-soft-600">
							<i class="fa-solid fa-bars text-sm"></i>
						</button>

						<div class="relative">
							<i class="fa-solid fa-search absolute left-3 top-2 text-soft-400 text-xs"></i>
							<input type="text" placeholder="Search..." class="pl-9 pr-3 py-1.5 text-sm border border-soft-300 rounded-lg focus:ring-accent-500 focus:border-accent-500 w-48 lg:w-64" />
						</div>
					</div>

					<div class="flex items-center space-x-3">
						<button class="relative p-2 rounded-md hover:bg-soft-100 text-soft-600">
							<i class="fa-solid fa-bell text-sm"></i>
							<span class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] h-4 w-4 rounded-full flex items-center justify-center">5</span>
						</button>

						<button class="p-2 rounded-md hover:bg-soft-100 text-soft-600">
							<i class="fa-solid fa-gear text-sm"></i>
						</button>

						<div class="h-8 w-8 rounded-full bg-accent-500 text-white flex items-center justify-center text-xs">JD</div>
					</div>
				</header>

				<!-- CONTENT -->
				<main class="flex-1 overflow-y-auto slim-scrollbar p-5 bg-soft-50">
					{% block content %}{% endblock %}
					<!-- Messages Alert -->
					{% if messages %}
					<div id="messages-container" class="fixed bottom-4 right-4 z-50 space-y-2">
						{% for message in messages %}
						<div class="message px-4 py-2 rounded shadow text-white {% if message.tags == 'success' %} bg-green-600 {% elif message.tags == 'error' %} bg-red-600 {% elif message.tags == 'warning' %} bg-yellow-500 {% else %} bg-blue-600 {% endif %}">{{ message }}</div>
						{% endfor %}
					</div>

					<script>
						// Automatically remove messages after 3 seconds
						setTimeout(() => {
							const container = document.getElementById("messages-container");
							if (container) {
								container.style.transition = "opacity 0.5s";
								container.style.opacity = "0";
								setTimeout(() => container.remove(), 500); // remove after fade out
							}
						}, 3000);
					</script>
					{% endif %}
				</main>
			</div>
		</div>

		<script>
			// thin sidebar toggle
			document.getElementById("sidebarToggle").addEventListener("click", () => {
				const sidebar = document.querySelector("aside");

				if (sidebar.classList.contains("w-16")) {
					sidebar.classList.remove("w-16");
					sidebar.classList.add("w-0", "overflow-hidden");
				} else {
					sidebar.classList.remove("w-0", "overflow-hidden");
					sidebar.classList.add("w-16");
				}
			});
		</script>
	</body>
</html>
